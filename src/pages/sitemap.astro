---
import Layout from "../layouts/Layout.astro";
import {
    TREATMENT_SLUGS,
    INSURANCE_SLUGS,
    COMPARE_SLUGS,
    TECHNOLOGY_SLUGS,
} from "../utils/seo_slugs";
import {
    getUniqueStates,
    getClinicsByState,
    STATE_NAMES,
    getStateSlug,
} from "../utils/dataHelpers";

// Get all states with content
const uniqueStates = getUniqueStates().sort();

// Prepare state data with city counts
const stateData = uniqueStates.map((stateCode) => {
    const clinics = getClinicsByState(stateCode);
    const cities = [
        ...new Set(clinics.map((c) => c.city).filter(Boolean)),
    ].sort();
    return {
        code: stateCode,
        name: STATE_NAMES[stateCode] || stateCode,
        slug: getStateSlug(stateCode),
        cityCount: cities.length,
        clinicCount: clinics.length,
    };
});

const title = "Sitemap | TMS List";
const description =
    "Complete site overview of TMS List. Browse all treatments, insurance providers, clinic locations, and comparison guides.";
---

<Layout title={title} description={description}>
    <main class="container mx-auto px-4 py-12 max-w-6xl">
        <div class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-black text-gray-900 mb-4">
                Sitemap
            </h1>
            <p class="text-xl text-gray-600">
                Browse our complete directory of TMS resources, locations, and
                guides.
            </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12">
            <!-- COLUMN 1: General & Treatments -->
            <div class="space-y-12">
                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        General
                    </h2>
                    <ul class="space-y-2">
                        <li>
                            <a
                                href="/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >Home</a
                            >
                        </li>
                        <li>
                            <a
                                href="/verified-clinics/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >Verified Clinics</a
                            >
                        </li>
                        <li>
                            <a
                                href="/specialists/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >Find a Specialist</a
                            >
                        </li>
                        <li>
                            <a
                                href="/about/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >About Us</a
                            >
                        </li>
                        <li>
                            <a
                                href="/blog/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >Blog & Guides</a
                            >
                        </li>
                        <li>
                            <a
                                href="/contact/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >Contact</a
                            >
                        </li>
                        <li>
                            <a
                                href="/add-listing/"
                                class="text-gray-600 hover:text-indigo-600 hover:underline"
                                >List Your Clinic (Free)</a
                            >
                        </li>
                    </ul>
                </section>

                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        Treatments
                    </h2>
                    <ul class="space-y-2">
                        {
                            TREATMENT_SLUGS.map((item) => (
                                <li>
                                    <a
                                        href={`/treatments/${item.slug}/`}
                                        class="text-gray-600 hover:text-indigo-600 hover:underline block py-0.5"
                                    >
                                        {item.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </section>
            </div>

            <!-- COLUMN 2: Comparisons & Technology -->
            <div class="space-y-12">
                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        Comparisons
                    </h2>
                    <ul class="space-y-2">
                        {
                            COMPARE_SLUGS.map((item) => (
                                <li>
                                    <a
                                        href={`/compare/${item.slug}/`}
                                        class="text-gray-600 hover:text-indigo-600 hover:underline block py-0.5"
                                    >
                                        {item.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </section>

                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        Technology
                    </h2>
                    <ul class="space-y-2">
                        {
                            TECHNOLOGY_SLUGS.map((item) => (
                                <li>
                                    <a
                                        href={`/technology/${item.slug}/`}
                                        class="text-gray-600 hover:text-indigo-600 hover:underline block py-0.5"
                                    >
                                        {item.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </section>
            </div>

            <!-- COLUMN 3: Insurance -->
            <div class="space-y-12">
                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        Insurance Coverage
                    </h2>
                    <ul class="space-y-2 text-sm">
                        {
                            INSURANCE_SLUGS.map((item) => (
                                <li>
                                    <a
                                        href={`/insurance/${item.slug}/`}
                                        class="text-gray-600 hover:text-indigo-600 hover:underline block py-0.5"
                                    >
                                        {item.title}
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                </section>
            </div>

            <!-- COLUMN 4: Locations (States) -->
            <div class="space-y-12">
                <section>
                    <h2
                        class="text-xl font-black text-gray-900 mb-4 border-b border-gray-200 pb-2"
                    >
                        Locations
                    </h2>
                    <div class="grid grid-cols-1 gap-2 text-sm">
                        {
                            stateData.map((state) => (
                                <a
                                    href={`/us/${state.slug}/`}
                                    class="group flex items-center justify-between text-gray-600 hover:text-indigo-600 hover:underline py-0.5"
                                >
                                    <span>{state.name}</span>
                                    <span class="text-xs text-gray-400 bg-gray-100 px-1.5 rounded group-hover:bg-indigo-50 group-hover:text-indigo-600">
                                        {state.cityCount} Cities
                                    </span>
                                </a>
                            ))
                        }
                    </div>
                </section>
            </div>
        </div>
    </main>
</Layout>
