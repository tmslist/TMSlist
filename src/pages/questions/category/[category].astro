---
import Layout from "../../../layouts/Layout.astro";
import questionsData from "../../../data/questions-comprehensive.json";

export async function getStaticPaths() {
    const categories = {
        basics: {
            name: "TMS Basics",
            description: "Understanding TMS therapy fundamentals",
        },
        cost: {
            name: "Cost & Insurance",
            description: "Pricing, coverage, and payment options",
        },
        conditions: {
            name: "Conditions Treated",
            description: "Effectiveness for different mental health conditions",
        },
        comparisons: {
            name: "Treatment Comparisons",
            description: "How TMS compares to other therapies",
        },
        location: {
            name: "Locations & Providers",
            description: "Finding and choosing TMS providers",
        },
        safety: {
            name: "Safety & Side Effects",
            description: "Understanding risks and safety protocols",
        },
        timeline: {
            name: "Treatment Timeline",
            description: "Duration, frequency, and what to expect",
        },
        experience: {
            name: "Patient Experience",
            description: "What it feels like and patient stories",
        },
        technology: {
            name: "Technology & Devices",
            description: "Different TMS machines and technologies",
        },
        procedure: {
            name: "The Procedure",
            description: "Step-by-step guide to TMS sessions",
        },
    };

    return Object.keys(categories).map((key) => {
        const categoryQuestions = questionsData.filter(
            (q) => q.category === key,
        );
        return {
            params: { category: key },
            props: {
                category: categories[key as keyof typeof categories],
                questions: categoryQuestions,
            },
        };
    });
}

const { category, questions } = Astro.props;

const title = `${category.name} Questions & Answers | TMS List`;
const description = `Expert answers to common questions about ${category.name.toLowerCase()}. ${category.description}.`;
---

<Layout title={title} description={description}>
    <main class="min-h-screen bg-gray-50 py-12">
        <div class="container mx-auto px-4">
            <!-- Breadcrumb -->
            <nav class="text-sm text-gray-500 mb-8">
                <a href="/" class="hover:text-gray-900">Home</a>
                <span class="mx-2">/</span>
                <a href="/questions/" class="hover:text-gray-900">Questions</a>
                <span class="mx-2">/</span>
                <span class="text-gray-900">{category.name}</span>
            </nav>

            <!-- Header -->
            <header class="mb-12 text-center">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
                    {category.name}
                </h1>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    {category.description}
                </p>
            </header>

            <!-- Questions Grid -->
            {
                questions.length > 0 ? (
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {questions.map((q) => (
                            <a
                                href={`/questions/${q.slug}/`}
                                class="group block p-6 bg-white rounded-xl border border-gray-200 hover:border-indigo-500 hover:shadow-xl transition-all"
                            >
                                <h2 class="font-bold text-lg text-gray-900 group-hover:text-indigo-600 transition-colors mb-3">
                                    {q.question}
                                </h2>
                                <p class="text-gray-600 text-sm line-clamp-3 mb-4">
                                    {q.quickAnswer}
                                </p>
                                <span class="text-indigo-600 text-sm font-semibold group-hover:underline">
                                    Read Answer →
                                </span>
                            </a>
                        ))}
                    </div>
                ) : (
                    <div class="text-center py-12">
                        <p class="text-gray-600 text-lg">
                            No questions found for this category yet.
                        </p>
                        <a
                            href="/questions/"
                            class="inline-block mt-4 text-indigo-600 font-semibold hover:underline"
                        >
                            Browse all questions →
                        </a>
                    </div>
                )
            }

            <!-- CTA -->
            <section
                class="mt-16 bg-white rounded-2xl p-8 md:p-12 shadow-lg text-center border border-gray-200"
            >
                <h2 class="text-3xl font-bold text-gray-900 mb-4">
                    Still have questions?
                </h2>
                <p class="text-gray-600 mb-8 max-w-2xl mx-auto">
                    Our comprehensive guide to TMS therapy has helped thousands
                    of patients make informed decisions.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a
                        href="/questions/"
                        class="px-6 py-3 bg-gray-100 text-gray-700 font-bold rounded-lg hover:bg-gray-200 transition-colors"
                    >
                        Browse All Topics
                    </a>
                    <button
                        onclick="document.dispatchEvent(new Event('open-enquiry-modal'))"
                        class="px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors shadow-md"
                    >
                        Talk to a Specialist
                    </button>
                </div>
            </section>
        </div>
    </main>
</Layout>
