---
import Layout from "../../layouts/Layout.astro";
import questionsData from "../../data/questions-seed.json";

export async function getStaticPaths() {
    return questionsData.map((q) => ({
        params: { slug: q.slug },
        props: { question: q },
    }));
}

const { question } = Astro.props;
const relatedQs = questionsData.filter((q) =>
    question.relatedQuestions?.includes(q.id),
);

const title = `${question.question} | TMS List Expert Answers`;
const description = question.quickAnswer;
---

<Layout title={title} description={description}>
    <main class="container mx-auto px-4 py-12 max-w-4xl">
        <!-- Breadcrumb -->
        <nav class="text-sm text-gray-500 mb-6">
            <a href="/" class="hover:text-gray-900">Home</a>
            <span class="mx-2">/</span>
            <a href="/questions/" class="hover:text-gray-900">Questions</a>
            <span class="mx-2">/</span>
            <span class="text-gray-900">{question.category}</span>
        </nav>

        <!-- Question Header -->
        <h1
            class="text-4xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight"
        >
            {question.question}
        </h1>

        <!-- Quick Answer Box -->
        <div
            class="bg-indigo-50 border-l-4 border-indigo-600 p-6 mb-8 rounded-r-lg"
        >
            <h2 class="text-lg font-bold text-indigo-900 mb-2">Quick Answer</h2>
            <p class="text-gray-800 leading-relaxed">{question.quickAnswer}</p>
        </div>

        <!-- Main Content -->
        <article class="prose prose-lg prose-indigo max-w-none mb-12">
            <h2>Detailed Explanation</h2>
            <p>
                {question.question} This is a common question among patients considering
                TMS therapy. Understanding the full context can help you make an informed
                decision about your mental health treatment.
            </p>

            <p
                class="text-gray-600 italic text-sm border-l-2 border-gray-200 pl-4 py-2 my-6"
            >
                ðŸ’¡ <strong>Note:</strong> This answer is based on FDA-cleared treatments
                and peer-reviewed clinical research. Always consult with a qualified
                healthcare provider for personalized medical advice.
            </p>

            <!-- Key Takeaways -->
            <h2>Key Takeaways</h2>
            <ul class="space-y-2">
                <li>TMS is an FDA-cleared, evidence-based treatment</li>
                <li>
                    Most insurance plans cover TMS for treatment-resistant
                    depression
                </li>
                <li>
                    Results typically appear after 4-6 weeks of daily sessions
                </li>
                <li>Side effects are minimal compared to medication</li>
            </ul>
        </article>

        <!-- Related Questions -->
        {
            relatedQs.length > 0 && (
                <section class="bg-gray-50 rounded-xl p-8 mb-12">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">
                        Related Questions
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {relatedQs.map((rq) => (
                            <a
                                href={`/questions/${rq.slug}/`}
                                class="group block p-4 bg-white rounded-lg border border-gray-200 hover:border-indigo-500 hover:shadow-md transition-all"
                            >
                                <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition-colors mb-1">
                                    {rq.question}
                                </h3>
                                <p class="text-sm text-gray-600 line-clamp-2">
                                    {rq.quickAnswer}
                                </p>
                            </a>
                        ))}
                    </div>
                </section>
            )
        }

        <!-- CTA Section -->
        <section
            class="bg-gradient-to-r from-indigo-600 to-blue-600 rounded-2xl p-8 text-center text-white mb-12"
        >
            <h2 class="text-3xl font-bold mb-4">Find TMS Providers Near You</h2>
            <p class="text-indigo-100 mb-6 max-w-2xl mx-auto">
                Connect with verified TMS clinics in your area. Compare prices,
                read reviews, and schedule free consultations.
            </p>
            <div class="flex gap-4 justify-center flex-wrap">
                <a
                    href="/us/"
                    class="px-6 py-3 bg-white text-indigo-600 font-bold rounded-xl hover:bg-indigo-50 transition-colors"
                >
                    Browse by State
                </a>
                <a
                    href="/near-me/"
                    class="px-6 py-3 bg-indigo-700 text-white font-bold rounded-xl hover:bg-indigo-800 transition-colors border-2 border-white/20"
                >
                    Find Near Me
                </a>
            </div>
        </section>

        <!-- Medical Disclaimer -->
        <div class="border-t border-gray-200 pt-8 text-sm text-gray-600">
            <h3 class="font-bold text-gray-900 mb-2">Medical Disclaimer</h3>
            <p>
                The information provided on this page is for educational
                purposes only and is not intended as medical advice. TMS List
                does not provide medical advice, diagnosis, or treatment. Always
                consult with a qualified healthcare provider regarding any
                questions you may have about a medical condition or treatment.
            </p>
            <p class="mt-4">
                <strong>Last Updated:</strong>
                {
                    new Date().toLocaleDateString("en-US", {
                        year: "numeric",
                        month: "long",
                        day: "numeric",
                    })
                }
            </p>
        </div>

        <!-- Schema Markup -->
        <script
            type="application/ld+json"
            set:html={JSON.stringify({
                "@context": "https://schema.org",
                "@type": "FAQPage",
                mainEntity: {
                    "@type": "Question",
                    name: question.question,
                    acceptedAnswer: {
                        "@type": "Answer",
                        text: question.quickAnswer,
                    },
                },
            })}
        />
    </main>
</Layout>
